task bundleZip(type: Zip) {
    archiveName 'modules.zip'
    destinationDir file("$buildDir")
}

if (!project.tasks.findByName('build')) {
    task build {
    }
}

configure(subprojects.findAll { it.name.endsWith('_module') }) {
    apply from: '../../scripts/lsrv_module.gradle'
}

configure(subprojects.findAll { it.name.endsWith('_swmodule') }) {
    apply from: '../../scripts/srvwrap_module.gradle'
}

configure(subprojects.findAll { it.name.endsWith('_lmodule') }) {
    apply from: '../../scripts/launch_module.gradle'
}

subprojects {
    parent.tasks.bundleZip.dependsOn tasks.jar
    parent.tasks.bundleZip.from tasks.jar
}

project.tasks.findByName('build').dependsOn tasks.bundleZip
